"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.containAtLeastOneItemThat = void 0;
const core_1 = require("@serenity-js/core");
function containAtLeastOneItemThat(expectation) {
    return new ContainAtLeastOneItemThatMeetsExpectation(expectation);
}
exports.containAtLeastOneItemThat = containAtLeastOneItemThat;
/**
 * @package
 */
class ContainAtLeastOneItemThatMeetsExpectation extends core_1.Expectation {
    constructor(expectation) {
        super(ContainAtLeastOneItemThatMeetsExpectation.descriptionFor(expectation), async (actor, actual) => {
            const items = await actor.answer(actual);
            if (!items || items.length === 0) {
                return new core_1.ExpectationNotMet(ContainAtLeastOneItemThatMeetsExpectation.descriptionFor(expectation), undefined, items);
            }
            let outcome;
            for (const item of items) {
                outcome = await actor.answer(expectation.isMetFor(item));
                if (outcome instanceof core_1.ExpectationMet) {
                    return new core_1.ExpectationMet(ContainAtLeastOneItemThatMeetsExpectation.descriptionFor(expectation), outcome.expected, items);
                }
            }
            return new core_1.ExpectationNotMet(ContainAtLeastOneItemThatMeetsExpectation.descriptionFor(expectation), outcome.expected, items);
        });
        this.expectation = expectation;
    }
    static descriptionFor(expectation) {
        return (0, core_1.d) `contain at least one item that does ${expectation}`;
    }
}
//# sourceMappingURL=containAtLeastOneItemThat.js.map